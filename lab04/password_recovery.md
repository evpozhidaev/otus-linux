# Сброс пароля для Centos 7

> [!NOTE]
> Инструкция не работает для Vagrant box

## Способ 1

Указываем загрузчику вместо процесса **/sbin/init** запусть шел /bin/sh получая доступ к файловой системе root.

1. При загрузке системы ждем появления меню выбора ядра с которого заргружается система и нажимаем клафишу **e** для редактирования меню. 
2. Находим строчку начинающаюся с **linux16** и в конце добавляем **init=/bin/sh**.
3. Нажимаем **CTRL-X** для продолжения загрузки.
4. Перемонтируем файловую систему в режим Read/Write:
```
mount -o remount,rw /
```
5. Меняем пароль root
```
passwd root
```
6. Указываем SELinux перемаркировать все файлы при следующей перезагрузке
```
touch /.autorelabel
```
7. Перезагрузка системы

```
exec /sbin/init 6
```


### Способ 2

Прерывание загрузки в момент когда ядро уже подмонтировало файловую систему root в /sysroot.

1. При загрузке системы ждем появления меню выбора ядра с которого заргружается система и нажимаем клафишу **e** для редактирования меню. 
2. Находим строчку начинающаюся с **linux16** и в конце добавляем **rd.break**.
3. Нажимаем **CTRL-X** для продолжения загрузки.
4. Перемонтируем файловую систему в режим Read/Write:
```
mount -o remount,rw /sysroot
```
5. Подменяем раздел root
```
chroot /sysroot
```
6. Указываем SELinux перемаркировать все файлы при следующей перезагрузке
```
touch /.autorelabel
```
7. Два раза набираем **exit** для выхода из chroot и перезагрузки системы
```
exit
exit
```

### Способ 3

Попадаем в режим single user с смонтированной файловой системой root в /sysroot

1. При загрузке системы ждемы появления меню выбора ядра с которого заргружается система и нажимаем клафишу **e** для редактирования меню. 
2. Находим строчку начинающаюся с **linux16** и в этой сроке находим слово **ro**, которое меняем на **rw init=/sysroot/bin/sh**.
3. Нажимаем **CTRL-X** для продолжения загрузки.
4. Подменяем раздел root
```
chroot /sysroot
```
5. Указываем SELinux перемаркировать все файлы при следующей перезагрузке
```
touch /.autorelabel
```
6. Выходим из chroot
```
exit
```
7. Перезагружаем систему

```
reboot
```